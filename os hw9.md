<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

# 第九次作业

1400012789 倪蕴哲

## 3.7

（假设TLB在程序开始时不包含任何有效内容，且M、N都是正整数）

a)  

① 若`N == 1`  
则M取任何值都满足题意；  

② 若`N != 1`  
则若`M >= N`，则与①同理可知此解符合题意；

③ 若`N != 1 && M < N`  
则需要保证任意连续的两次访存都会访问不同的页面。此时必须有`M >= 1024`。  
而只要`M >= 1024`，由于这些页面的页表项在程序开始之前并不在TLB中，故程序内层循环的访存是第一次访问这些页面，故一定会造成不命中。于是只须`M >= 1024`。

综上，所求解为：  
`N == 1 || (N != 1 && M >= N) || (N != 1 && M < N && M > 1024)`，即`N <= M || M >= 1024`

b)

不同。  
设N = 2048，M = 1024，则易知这是a)的一个解。但若重复执行两次此程序，则第二次不会产生TLB失效。

由a)的推导过程可知，第一次访问失效是因为页表项不曾在TLB中存在过。而只要保证这些页表项在第一次访问后仍在TLB中就可以保证第二次访问不失效。此时若要第二次（以及以后）失效，需在a)的基础上保证表项在下一次执行循环时被引用之前就被换出TLB。

## 3.9

装入页表的耗时为：

`(100 * (1 << 32) / (1 << 13))` = 52,428,800ns = 52.4288ms

故用于装入页表的CPU时间的比例是52.4288%。

## 3.15

解不等式：\\(5p + (1 - p) < 2\\)